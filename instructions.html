<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="./styles/global.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>VPN Инструкции</title>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                if (typeof window !== 'undefined' && window.Telegram?.WebApp) {
                    const tg = window.Telegram.WebApp;
                    tg.ready();
                    tg.expand();
                    tg.disableVerticalSwipes();

                    if (tg.requestFullscreen) {
                        tg.requestFullscreen();
                        window.Telegram.WebApp.disableClosingConfirmation();
                    } else {
                        tg.expand();
                    }
                }
            } catch (e) {
                console.error(e);
            }
        });
    </script>
</head>
<body>
<header>
    <h1>Инструкции по настройке VPN</h1>
</header>
<div class="container">
    <h2>Шаг 1: Выберите вашу платформу</h2>
    <div class="button-group">
        <button onclick="selectPlatform('ios')">iOS</button>
        <button onclick="selectPlatform('android')">Android</button>
        <button onclick="selectPlatform('pc')">ПК</button>
    </div>

    <div id="app-description" class="hidden">
        <h2>Шаг 2: Выберите приложение</h2>
        <div id="platform-description"></div>
        <div class="button-group" id="app-buttons"></div>
    </div>

    <div id="instructions">
        <!-- Hiddify iOS -->
        <div id="hiddify-ios" class="video-section">
            <h2>Hiddify iOS</h2>
            <div class="main-video-container">
                <div class="video main-video custom-video-wrapper">
                    <iframe class="vk-video" src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239045&hd=2" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/ios-hiddify-button.mp4"></video>-->
                </div>
                <div class="action-container">
                    <p class="important-text">ВАЖНО!<br><br>Для скачивания Hiddify, необходимо сменить регион AppStore
                    </p>
                    <a href="https://apps.apple.com/app/id6596777532" class="action-button-download">Скачать Hiddify</a>
                    <a href="hiddify://import/" class="action-button-connect">Подключить VPN</a>
                </div>
            </div>
            <button class="toggle-other-videos" onclick="toggleOtherVideos('hiddify-ios')">Показать другие варианты
            </button>
            <div class="other-videos">
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239045&hd=2" width="240" height="520" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/ios-hiddify-link.mp4"></video>-->
                </div>
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239049&hd=2&" width="240" height="520" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/ios-hiddify-qr.mp4"></video>-->
                </div>
            </div>
        </div>

        <!-- V2Box iOS -->
        <div id="v2box-ios" class="video-section">
            <h2>V2Box iOS</h2>
            <div class="main-video-container">

                <div class="video main-video custom-video-wrapper">
<!--                    <video src="./videos/ios-v2box-button.mp4"></video>-->
                </div>

                <div class="action-container">
                    <a href="https://apps.apple.com/app/id6446814690" class="action-button-download">Скачать V2Box</a>
                    <a href="" class="action-button-connect">Подключить VPN</a>
                </div>
            </div>
            <button class="toggle-other-videos" onclick="toggleOtherVideos('v2box-ios')">Показать другие варианты
            </button>
            <div class="other-videos">

                <div class="video main-video custom-video-wrapper">
<!--                    <video src="./videos/ios-v2box-link.mp4"></video>-->
                </div>
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239050&hd=2" width="240" height="520" allow=" encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/ios-v2box-qr.mp4"></video>-->
                </div>

            </div>
        </div>

        <!-- Hiddify Android -->
        <div id="hiddify-android" class="video-section">
            <h2>Hiddify Android</h2>
            <div class="main-video-container">

                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239042&hd=2&" width="240" height="520" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/android-hiddify-button.mp4"></video>-->
                </div>

                <div class="action-container">
                    <a href="https://github.com/hiddify/hiddify-next/releases/latest/download/Hiddify-Android-universal.apk"
                       class="action-button-download">Скачать Hiddify</a>
                    <a href="hiddify://import/" class="action-button-connect">Подключить VPN</a>
                </div>
            </div>
            <button class="toggle-other-videos" onclick="toggleOtherVideos('hiddify-android')">Показать другие
                варианты
            </button>
            <div class="other-videos">

                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239043&hd=2" width="240" height="520" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/android-hiddify-link.mp4"></video>-->
                </div>
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239044&hd=2" width="240" height="520" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/android-hiddify-qr.mp4"></video>-->
                </div>

            </div>
        </div>

        <!-- V2Box Android -->
        <div id="v2box-android" class="video-section">
            <h2>V2Box Android</h2>
            <div class="main-video-container">

                <div class="video main-video custom-video-wrapper">
<!--                    <video src="./videos/android-v2box-button.mp4"></video>-->
                </div>

                <div class="action-container">
                    <a href="./videos/V2Box+-+V2ray+Client_2.3.0.apk" class="action-button-download">Скачать V2Box</a>
                    <a href="" class="action-button-connect">Подключить VPN</a>
                </div>
            </div>
            <button class="toggle-other-videos" onclick="toggleOtherVideos('v2box-android')">Показать другие варианты
            </button>
            <div class="other-videos">

                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239045&hd=2" width="240" height="520" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/android-v2box-link.mp4"></video>-->
                </div>
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239046&hd=2" width="240" height="520" allow="encrypted-media; fullscreen; picture-in-picture; screen-wake-lock;" frameborder="0" allowfullscreen></iframe>
<!--                    <video src="./videos/android-v2box-qr.mp4"></video>-->
                </div>

            </div>
        </div>

        <!-- Hiddify PC -->
        <div id="hiddify-pc" class="video-section">
            <h2>Hiddify ПК</h2>
            <div class="main-video-container">
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239040&hash=44d422c36acf702e" width="240" height="520" frameborder="0" allow="encrypted-media; fullscreen; picture-in-picture"></iframe>
<!--                    <video src="./videos/pc-hiddify-button.mp4"></video>-->
                </div>
                <div class="action-container">
                    <a href="https://github.com/hiddify/hiddify-next/releases/latest/download/Hiddify-Windows-Setup-x64.exe"
                       class="action-button-download">Скачать для Windows</a>
                    <a href="https://github.com/hiddify/hiddify-next/releases/latest/download/Hiddify-MacOS-Installer.pkg"
                       class="action-button-download">Скачать для MacOS</a>
                    <a href="https://hiddify.com/" class="action-button-download">Скачать для Linux</a>
                    <a href="hiddify://import/" class="action-button-connect">Подключить VPN</a>
                </div>
            </div>
            <button class="toggle-other-videos" onclick="toggleOtherVideos('hiddify-pc')">Показать другие варианты
            </button>
            <div class="other-videos">
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239041&hash=6e895ef416e03208" width="640" height="360" frameborder="0" allowfullscreen="1" allow="encrypted-media; fullscreen; picture-in-picture"></iframe>
<!--                    <video src="./videos/pc-hiddify-link.mp4"></video>-->
                </div>
            </div>
        </div>

        <!-- Region iOS -->
        <div id="region-ios" class="video-section">
            <h2>Смена региона AppStore</h2>
            <div class="main-video-container">
                <div class="video main-video custom-video-wrapper">
                    <iframe src="https://vkvideo.ru/video_ext.php?oid=-222398573&id=456239039&hash=9307b3e3f6efe933" width="240" height="520" frameborder="0" allowfullscreen="1" allow="encrypted-media; fullscreen; picture-in-picture"></iframe>
                </div>
                <div class="action-container">
                    <p>Подробная инструкция по смене региона AppStore</p>
                    <a href="https://apps.apple.com/app/id6596777532" class="action-button-download">Скачать Hiddify</a>
                    <a href="hiddify://import/" class="action-button-connect">Подключить VPN</a>
                </div>
            </div>
            <!-- Нет других видео, поэтому кнопка не нужна -->
        </div>
    </div>
</div>

<script>
    const appOptions = {
        ios: [
            {label: 'Hiddify', value: 'hiddify-ios'},
            {label: 'V2Box', value: 'v2box-ios'},
            {label: 'Смена региона AppStore', value: 'region-ios'}
        ],
        android: [
            {label: 'Hiddify', value: 'hiddify-android'},
            {label: 'V2Box', value: 'v2box-android'}
        ],
        pc: [
            {label: 'Hiddify', value: 'hiddify-pc'}
        ]
    };

    const platformDescriptions = {
        ios: `
            <p class="important-text">ВАЖНО! Для скачивания Hiddify, необходимо сменить регион AppStore.</p><p><strong>Hiddify</strong> — простое и удобное приложение для подключения к VPN, рекомендовано для большинства пользователей.</p>
            <p><strong>V2Box</strong> — более продвинутое приложение с гибкими настройками для опытных пользователей.</p>
        `,
        android: `
            <p><strong>Hiddify</strong> — простое и удобное приложение для подключения к VPN, рекомендовано для большинства пользователей.</p>
            <p><strong>V2Box</strong> — более продвинутое приложение с гибкими настройками для опытных пользователей.</p>
        `,
        pc: `
            <p><strong>Hiddify</strong> — простое и удобное приложение для подключения к VPN, рекомендовано для пользователей ПК.</p>
        `
    };

    function selectPlatform(platform) {
        const appDesc = document.getElementById('app-description');
        const appButtons = document.getElementById('app-buttons');
        const platformDesc = document.getElementById('platform-description');
        appButtons.innerHTML = '';
        platformDesc.innerHTML = '';

        if (appOptions[platform]) {
            // Заполняем кнопки приложений
            appOptions[platform].forEach(app => {
                const btn = document.createElement('button');
                btn.textContent = app.label;
                btn.onclick = () => showInstructions(app.value);
                appButtons.appendChild(btn);
            });
            // Устанавливаем описание платформы
            platformDesc.innerHTML = platformDescriptions[platform] || '';
            appDesc.classList.remove('hidden');
        } else {
            appDesc.classList.add('hidden');
        }

        // Скрыть все видеоинструкции при смене платформы
        document.querySelectorAll('.video-section').forEach(el => {
            el.style.display = 'none';
            const otherVideos = el.querySelector('.other-videos');
            if (otherVideos) {
                otherVideos.style.display = 'none';
            }
            const toggleButton = el.querySelector('.toggle-other-videos');
            if (toggleButton) {
                toggleButton.textContent = 'Показать другие варианты';
            }
        });
    }

    function showInstructions(id) {
        document.querySelectorAll('.video-section').forEach(el => {
            el.style.display = 'none';
            const otherVideos = el.querySelector('.other-videos');
            if (otherVideos) {
                otherVideos.style.display = 'none';
            }
            const toggleButton = el.querySelector('.toggle-other-videos');
            if (toggleButton) {
                toggleButton.textContent = 'Показать другие варианты';
            }
        });
        const section = document.getElementById(id);
        if (section) {
            section.style.display = 'block';
        }
    }

    function toggleOtherVideos(sectionId) {
        const section = document.getElementById(sectionId);
        const otherVideos = section.querySelector('.other-videos');
        const toggleButton = section.querySelector('.toggle-other-videos');
        if (otherVideos.style.display === 'none' || otherVideos.style.display === '') {
            otherVideos.style.display = 'flex';
            toggleButton.textContent = 'Скрыть другие варианты';
        } else {
            otherVideos.style.display = 'none';
            toggleButton.textContent = 'Показать другие варианты';
        }
    }
</script>

<script>
    const params = new URLSearchParams(window.location.search);
    const configParam = params.get('config');

    if (configParam) {
        document.querySelectorAll('.action-button-connect').forEach(btn => {
            const section = btn.closest('.video-section');
            if (!section) return;

            const id = section.id.toLowerCase();
            if (id.includes('hiddify')) {
                btn.href = `https://ryayar.github.io/redirect-page?config=hiddify://import/${decodeURIComponent(configParam)}`;
            } else if (id.includes('v2box')) {
                btn.href = `https://ryayar.github.io/redirect-page?config=${decodeURIComponent(configParam)}`;
            } else if (id.includes('region')) {
                btn.href = `https://ryayar.github.io/redirect-page?config=hiddify://import/${decodeURIComponent(configParam)}`;
            } else {
                // fallback (например, для region-ios)
                btn.href = `${decodeURIComponent(configParam)}`;
            }
        });
    }
</script>

</body>
</html>
